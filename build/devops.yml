name: $(BuildID)_$(BuildDefinitionName)_$(SourceBranchName)_$(Date:yyyyMMdd)$(Rev:.r)
resources:
  repositories:
  - repository: self
    clean: true
  - repository: c_build_tools
    type: github
    name: azure/c-build-tools
    endpoint: github.com_azure
    ref: refs/heads/master

jobs:
- template: /pipeline_templates/build_all_flavors.yml@c_build_tools
  parameters:
    cmake_options: '-Drun_repo_validation:BOOL=ON'
    failOnMinTestsNotRun: false

- template: /pipeline_templates/run_master_check.yml@c_build_tools

- template: /pipeline_templates/codeql3000_default.yml@c_build_tools

- template: /pipeline_templates/build_linux.yml@c_build_tools
  parameters:
    cmake_options: '-Drun_valgrind:BOOL=ON -Drun_helgrind:BOOL=ON -Drun_drd:BOOL=ON -Drun_int_tests:bool=ON -Drun_reals_check:bool=OFF'

